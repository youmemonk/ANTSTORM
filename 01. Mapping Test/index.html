<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <h1>Assets and Templates</h1>

    <!-- Cycle dropdown -->
    <select name="Cycle" id="Cycle" onchange="selectCycle()">
        <option value="" disabled selected>Choose a Business cycle
        </option>
        <option value="Consulting">Consulting
        </option>
        <option value="Delivery">Delivery
        </option>
    </select>

    <!-- BU dropdown -->
    <!-- <select name="Business Unit" id="BU" onchange="selectBU()">
        <option value="" disabled selected>Choose a Business Unit (BU)
        </option>
        <option value="AI">Artificial Intelligence
        </option>
        <option value="CE">Cloud Engineering
        </option>
        <option value="D&A">Data & Analytics
        </option>
        <option value="SE">Software Engineering
        </option>
        <option value="WM">Work Modernization
        </option>
    </select> -->
    <!-- <button onclick="selectBU()">Click</button> -->

    <div id="dummy">
        <select name="Dummy Select">
            <option value=" " disabled >Select Cycle First
            </option>
        </select>
        <!-- <h2>Dummy Div</h2> -->
    </div>




    <script>
        var acronyms = {
            "AI": "Artificial Intelligance",
            "CE": "Cloud Engineering",
            "D&A": "Data & Analytics",
            "SE": "Software Engineering",
            "WM": "Work Mordernisation"
        }
        //? Dummy options -> Get real options from backend
        //! Agenda:  Value from html -> Appscript -> return html -> console.log

        //! Gets Value from Cycle Dropdown, passes to Backend, fetches & returns folder id
        function selectCycle() {
            var cycleParam = document.getElementById('Cycle').value;

            google.script.run
                .withSuccessHandler(getBUFolderId)
                .withUserObject(this)
                .cycle(cycleParam);
        }

        var chosenBUFolderId;

        function getBUFolderId(dt) {
            chosenBUFolderId = dt[0]
            console.log(chosenBUFolderId)
            var temp = dt[1];
            console.log(temp)
            //? Get list from backend 
            var finaloptions = []
            for (var i = 0; i < temp.length; i++) {
                finaloptions[i] = `<option value=${temp[i]}>` + acronyms[temp[i]] + "</option>";
            }
            // function buttonclick(){
            document.getElementById('dummy').innerHTML = `<select id="BU" onchange="selectBU()"> + "<option value="" disabled selected>Choose a Business Unit (BU)
        </option>" +  ${finaloptions.join()} + </select>`;
            // }
        }

        //! Gets Value from BU Dropdown, passes to Backend, fetches & returns folder id
        function selectBU() {
            var buElement = document.getElementById('BU').value;

            google.script.run
                .withSuccessHandler(getMasterSheetId)
                .withUserObject(this)
                .mastersheetLocation(buElement, Object.values(chosenBUFolderId)[0]);


        }
        var chosenSheetId;

        function getMasterSheetId(dt) {
            chosenSheetId = dt
            console.log(chosenSheetId)
        }
    </script>
</body>

</html>